<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="statgenIBD">
<title>IBD probabilities file format • statgenIBD</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="IBD probabilities file format">
<meta property="og:description" content="statgenIBD">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">statgenIBD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--other-packages">
    <span class="fa fa-seedling"></span>
     
    other packages
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--other-packages">
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenSTA">statgenSTA</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenHTP">statgenHTP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Biometris/statgenIBD">
    <span class="fa fa-github fa-lg fab"></span>
     
    github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="IBDFileFormat_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>IBD probabilities file format</h1>
                        <h4 data-toc-skip class="author">Johannes Kruisselbrink</h4>
            
            <h4 data-toc-skip class="date">2022-08-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenIBD/blob/HEAD/vignettes/IBDFileFormat.Rmd" class="external-link"><code>vignettes/IBDFileFormat.Rmd</code></a></small>
      <div class="d-none name"><code>IBDFileFormat.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="file-format">File format<a class="anchor" aria-label="anchor" href="#file-format"></a>
</h2>
<p>The results of IBD probability calculations can be stored to and loaded from plain text, tab-delimited <em>.txt</em> or <em>.ibd</em> files using the functions <code>writeIBDs</code> and <code>readIBDs</code>. An IBD file should contain a header line, with the first and second header named <em>Marker</em> and <em>Genotype</em> to indicate the marker names and genotype names columns. The remaining headers should contain the parent names to indicate the columns holding the parent IBD probabilities. Each row in the file should hold the IBD probabilities of the corresponding marker and genotype. I.e., the probability that marker ‘x’ of genotype ‘y’ descends from parent ‘z’.</p>
<p>An example of the contents of a file with IBD probabilities is shown in the table below:</p>
<table class="table">
<thead><tr class="header">
<th>Marker</th>
<th>Genotype</th>
<th>Parent1</th>
<th>Parent2</th>
<th>…</th>
<th>ParentN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>M001</td>
<td>G001</td>
<td>0.5</td>
<td>0.5</td>
<td>…</td>
<td>0</td>
</tr>
<tr class="even">
<td>M001</td>
<td>G002</td>
<td>0</td>
<td>1</td>
<td>…</td>
<td>0</td>
</tr>
<tr class="odd">
<td>M001</td>
<td>G003</td>
<td>0</td>
<td>0.5</td>
<td>…</td>
<td>0.5</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>M002</td>
<td>G001</td>
<td>0</td>
<td>0.5</td>
<td>…</td>
<td>0.5</td>
</tr>
<tr class="even">
<td>M002</td>
<td>G002</td>
<td>0.25</td>
<td>0.75</td>
<td>…</td>
<td>0</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>Note that for large data sets, this file can become very large. It is therefore recommended to store this file in a compressed file format. This can be done directly setting <code>compress = TRUE</code> in <code>writeIBDs</code>.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="writing-ibd-probabilities-to-a-file">Writing IBD probabilities to a file<a class="anchor" aria-label="anchor" href="#writing-ibd-probabilities-to-a-file"></a>
</h3>
<p>After having computed IBD probabilities, the results can be written to a <em>.txt</em> or <em>.ibd</em> file using <code>writeIBDs</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Compute IBD probabilities for Steptoe Morex.</span></span>
<span><span class="va">SxMIBD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcIBD.html">calcIBD</a></span><span class="op">(</span>popType <span class="op">=</span> <span class="st">"DH"</span>,</span>
<span>                  markerFile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/SxM"</span>, <span class="st">"SxM_geno.txt"</span>,</span>
<span>                                           package <span class="op">=</span> <span class="st">"statgenIBD"</span><span class="op">)</span>,</span>
<span>                  mapFile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/SxM"</span>, <span class="st">"SxM_map.txt"</span>,</span>
<span>                                        package <span class="op">=</span> <span class="st">"statgenIBD"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write IBDs to tab-delimited .txt file.</span></span>
<span><span class="fu"><a href="../reference/writeIBDs.html">writeIBDs</a></span><span class="op">(</span><span class="va">SxMIBD</span>, <span class="st">"SxM-IBD.txt"</span><span class="op">)</span></span></code></pre></div>
<p>The created file will look like as follows:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Marker</th>
<th align="left">Genotype</th>
<th align="right">Morex</th>
<th align="right">Steptoe</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">plc</td>
<td align="left">dh001</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">plc</td>
<td align="left">dh002</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">plc</td>
<td align="left">dh003</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">plc</td>
<td align="left">dh004</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">plc</td>
<td align="left">dh005</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">plc</td>
<td align="left">dh006</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>When writing the probabilities to a file it is possible to set the maximum number of decimals written for the probabilities using the <code>decimals</code> argument. By default 6 decimals are written to the output. Trailing zeros are always removed. Values lower than a threshold specified by <code>minProb</code> can be set to 0.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Write IBDs to file, set values &lt;0.05 to zero and only print 3 decimals.</span></span>
<span><span class="fu"><a href="../reference/writeIBDs.html">writeIBDs</a></span><span class="op">(</span>IBDprob <span class="op">=</span> <span class="va">SxMIBD</span>, outFile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span>,</span>
<span>          decimals <span class="op">=</span> <span class="fl">3</span>, minProb <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reading-ibd-probabilities-from-file">Reading IBD probabilities from file<a class="anchor" aria-label="anchor" href="#reading-ibd-probabilities-from-file"></a>
</h3>
<p>Retrieving the IBD probabilities later on can be done using <code>readIBDs</code>. This requires the not only the file with IBD probabilities, but also the corresponding map file as a <code>data.frame</code>. In this example we can use the map from the <code>SxMIBD</code> object constructed earlier.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Get map.</span></span>
<span><span class="va">SxMMap</span> <span class="op">&lt;-</span> <span class="va">SxMIBD</span><span class="op">$</span><span class="va">map</span></span>
<span></span>
<span><span class="co">## Read IBDs to tab-delimited .txt file.</span></span>
<span><span class="va">SxMIBD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readIBDs.html">readIBDs</a></span><span class="op">(</span><span class="st">"SxM-IBD.txt"</span>, map <span class="op">=</span> <span class="va">SxMMap</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SxMIBD</span><span class="op">)</span></span>
<span><span class="co">#&gt; population type:  undefined </span></span>
<span><span class="co">#&gt; Number of evaluation points:  116 </span></span>
<span><span class="co">#&gt; Number of individuals:  150 </span></span>
<span><span class="co">#&gt; Parents:  Morex Steptoe</span></span></code></pre></div>
<p>When reading the probabilities all values read are rescaled in such a way that the sum of the probabilities for each genotype x marker combination is equal to 1.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Boer, Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
