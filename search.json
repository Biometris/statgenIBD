[{"path":"/articles/IBDCalculations.html","id":"the-statgenibd-package","dir":"Articles","previous_headings":"","what":"The statgenIBD package","title":"IBD calculations using statgenIBD","text":"statgenIBD package developed easy--use package Identity Descent (IBD) calculations common populations used plant breeding. calculations IBDs based Hidden Markov Models (HMM) inheritance vectors. details theory see Lander Green (1987) Huang et al. (2011). vignette describes perform calculations interpret use outputs. done using number example data sets, real life simulated.","code":""},{"path":"/articles/IBDCalculations.html","id":"population-types","dir":"Articles","previous_headings":"","what":"Population types","title":"IBD calculations using statgenIBD","text":"package, IBD probabilities can calculated many different types populations. following table supported populations listed. Note value x population types variable, maximum value depicted last column. IBD calculations complex population types, including MAGIC population complicated pedigree structure, see RABBIT software (Zheng, Boer, Van Eeuwijk 2014, 2015, 2018).","code":""},{"path":"/articles/IBDCalculations.html","id":"examples","dir":"Articles","previous_headings":"","what":"Examples","title":"IBD calculations using statgenIBD","text":"demonstrate basic functionality package using example data sets. first example real life data set relatively simple doubled haploid population. highlight specifics complex populations crosses, use simulated data.","code":""},{"path":"/articles/IBDCalculations.html","id":"steptoe-morex","dir":"Articles","previous_headings":"Examples","what":"Steptoe Morex","title":"IBD calculations using statgenIBD","text":"first example Steptoe Morex data, described (Hayes et al. 1993). population 150 barley doubled haploid lines parentage Steptoe / Morex. population developed North American Barley Genome Mapping Project Oregon State University Barley Breeding Program. full description see website program. map genotypic file population included package. map genotypic file tab-delimited format. map file file without header. contain three columns, corresponding marker name, chromosome number position chromosome centiMorgan. genotypic file file header containing marker names. first column contain genotypes, starting parents, case Morex Steptoe. name column irrelevant can even empty string example. parents assumed inbred lines, without missing scores. Steptoe x Morex example, markers Morex 1, Steptoe 2. original SNP data can also used. Missing marker scores offspring value “-”. general, populations SNP scores b parents, offspring can scored (/), b (b/b), /b, /-, -/b, -. Using map genotypic files can compute IBD probabilities using calcIBD. function computes, per genotype marker, probability descended either parent. information known marker input, probabilities simply 0 one parents 1 . marker score missing input, probabilities calculated using information markers chromosome. output calcIBD function object class IBDprob. object list consists five elements: summary function can used get short description content IBDprob object. Looking genotype dh001 marker plc can see genotypic file printed value 2, equal Steptoe. now look output calcIBD shows value 1 pSteptoe value 0 pMorex. combination marker abg313b genotype dh005 genotypic file contained missing value. Looking output can see probability marker came Morex 0.67 probability came Steptoe 0.33.","code":"## Read the map and display the first rows. map <- read.table(system.file(\"extdata/SxM\", \"SxM_map.txt\", package = \"statgenIBD\")) head(map) #>       V1 V2   V3 #> 1    plc  1  0.0 #> 2    glx  1 18.7 #> 3 wg789a  1 24.1 #> 4 abg380  1 33.5 #> 5 abc158  1 40.2 #> 6 ksua1a  1 44.2 ## Read the genotypic file and display the first rows and columns. geno <- read.table(system.file(\"extdata/SxM\", \"SxM_geno.txt\", package = \"statgenIBD\"),                    header = TRUE) head(geno[, 1:5]) #>         plc glx wg789a abg380 abc158 #> Morex     1   1      1      1      1 #> Steptoe   2   2      2      2      2 #> dh001     2   1      1      1      1 #> dh002     2   2      2      2      2 #> dh003     2   2      2      2      2 #> dh004     2   2      2      2      1 ## Compute IBD probabilities for Steptoe Morex. SxMIBD <- calcIBD(popType = \"DH\",                   markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                            package = \"statgenIBD\"),                   mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                         package = \"statgenIBD\"))  ## Print summary. summary(SxMIBD) #> population type:  DH  #> Number of evaluation points:  116  #> Number of individuals:  150  #> Parents:  Morex Steptoe SxMIBD$markers[\"plc\", \"dh001\", ] #>   pMorex pSteptoe  #>        0        1 SxMIBD$markers[\"abg313b\", \"dh005\", ] #>    pMorex  pSteptoe  #> 0.6702599 0.3297401"},{"path":"/articles/IBDCalculations.html","id":"visualizing-results","dir":"Articles","previous_headings":"Examples","what":"Visualizing results","title":"IBD calculations using statgenIBD","text":"calculated IBD probabilities can visualized using plot function. Three types plot can made using function. plotType = \"pedigree\" create plot showing pedigree population IBD probabilities computed.  plotType = \"singleGeno\" generate plot probabilities per parent selected genotype. plot dh005 made . Note contains lot white space since markers file spread widely along genome. next section show compute probabilities denser grid.  second type plot can made specifying plotType = \"allGeno\". generate plot genotypes colored per evaluation position according parent highest probability combination genotype position. Darker colors indicate higher probability. Dashed lines indicate start new chromosome.","code":"### Visualize the pedigree of the population. plot(SxMIBD,      plotType = \"pedigree\") ## Visualize IBD probabilities for dh005. plot(SxMIBD,       plotType = \"singleGeno\",      genotype = \"dh005\") ## Visualize IBD probabilities for all genotypes. plot(SxMIBD,       plotType = \"allGeno\",      genotype = \"dh005\")"},{"path":"/articles/IBDCalculations.html","id":"evaluation-positions","dir":"Articles","previous_headings":"Examples","what":"Evaluation positions","title":"IBD calculations using statgenIBD","text":"calling calcIBD function without extra parameters, positions calculations made positions present map. two ways change . first option specify parameter evalDist. Setting value e.g. 5, assures extra evaluation positions added way maximum distance evaluation points 5 cM. Adding extra evaluation points can done grid setting grid = TRUE. defines grid evaluation points beginning chromosome end distance evaluation points evalDist. original marker positions ignored case. use evaluation points regular grid important haplotype construction efficient detection QTLs (Van Eeuwijk et al. 2009). summary shows, number evaluation points increased 1138. also show visualize results. positions crossovers different chromosomes clearly visible now.  setting grid = FALSE extra evaluation positions included existing marker positions. extra evaluation points spread evenly. look map Steptoe Morex example, see distance first two markers chromosome 1, plc glx, 18.7. assure maximum distance evaluation points 5, 3 extra evaluation points added. Since spread evenly, distance 18.7/3 = 4.68. extra evaluation points named EXT_chr_pos, e.g extra evaluation point position 4.68 chromosome 1, named EXT_1_4.68. summary shows, number evaluation point increased 290, 116 original calculation map positions. Looking first rows map output, see indeed 3 extra evaluation points added plc glx. second way changing position computations made, specifying data.frame. data.frame two columns, “chr” “pos” can specified calcIBD function using evalPos parameter. package simple example data.frame Steptoe Morex data included .txt file . three evaluation positions specified chromosomes. using data.frame evaluation position, IBD calculations made positions data.frame. information map file still used computations, marker positions evaluations done. evaluation points named EVAL_chr_pos, e.g first evaluation point file, position 0 chromosome 1, named EVAL_1_0. summary shows, number evaluation points now decreased 21, 3 7 chromosomes. case evalPos evalDist specified former takes prevalence evalDist ignored.","code":"## Compute IBD probabilities for Steptoe Morex. ## Add extra evaluation positions on dense grid. SxMIBD_Ext_grid <- calcIBD(popType = \"DH\",                            markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                                     package = \"statgenIBD\"),                            mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                                  package = \"statgenIBD\"),                            evalDist = 1,                            grid = TRUE)  ## Print summary. summary(SxMIBD_Ext_grid) #> population type:  DH  #> Number of evaluation points:  1138  #> Number of individuals:  150  #> Parents:  Morex Steptoe ## Visualize IBD probabilities for dh005 plot(SxMIBD_Ext_grid,       genotype = \"dh005\") ## Compute IBD probabilities for Steptoe Morex. ## Add extra evaluation positions between existing markers. SxMIBD_Ext <- calcIBD(popType = \"DH\",                       markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                                package = \"statgenIBD\"),                       mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                             package = \"statgenIBD\"),                       evalDist = 5,                       grid = FALSE)  ## Print summary. summary(SxMIBD_Ext) #> population type:  DH  #> Number of evaluation points:  290  #> Number of individuals:  150  #> Parents:  Morex Steptoe ## Show first rows of map in output. head(SxMIBD_Ext$map) #>             chr   pos #> plc           1  0.00 #> EXT_1_4.68    1  4.68 #> EXT_1_9.35    1  9.35 #> EXT_1_14.02   1 14.02 #> glx           1 18.70 #> EXT_1_21.4    1 21.40 ## Read the evalPos file and display the first rows. evalPos <- read.table(system.file(\"extdata/SxM\", \"SxM_eval.txt\", package = \"statgenIBD\"),                        header = TRUE) head(evalPos) #>   chr pos #> 1   1   0 #> 2   1  20 #> 3   1  40 #> 4   2   0 #> 5   2  20 #> 6   2  40 SxMIBD_evalPos <- calcIBD(popType = \"DH\",                           markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                                    package = \"statgenIBD\"),                           mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                                 package = \"statgenIBD\"),                           evalPos = evalPos)  ## Print summary. summary(SxMIBD_evalPos) #> population type:  DH  #> Number of evaluation points:  21  #> Number of individuals:  150  #> Parents:  Morex Steptoe"},{"path":"/articles/IBDCalculations.html","id":"extracting-value-for-markers-of-interest","dir":"Articles","previous_headings":"Examples","what":"Extracting value for markers of interest","title":"IBD calculations using statgenIBD","text":"Often subset markers interest analysis, e.g. QTL Mapping fitting multi-QTL model. extract computed probabilities marker subset calcIBD object can use getProbs function. output getProbs function data.frame column geno containing genotype markers probability descended Morex descended Steptoe.","code":"## Extract marker probabilities for markers plc and ABG053. SxM_probs <- getProbs(SxMIBD, markers = c(\"plc\", \"ABG053\")) head(SxM_probs) #>    geno plc_Morex plc_Steptoe ABG053_Morex ABG053_Steptoe #> 1 dh001         0           1            0              1 #> 2 dh002         0           1            1              0 #> 3 dh003         0           1            1              0 #> 4 dh004         0           1            1              0 #> 5 dh005         0           1            1              0 #> 6 dh006         0           1            1              0"},{"path":"/articles/IBDCalculations.html","id":"write-results-to-flapjack-format","dir":"Articles","previous_headings":"Examples","what":"Write results to Flapjack format","title":"IBD calculations using statgenIBD","text":"results IBD calculations can written Flapjack (Milne et al. 2010) format using writeFlapjack. Two files written can imported directly Flapjack, map file genotypic file. genotypic file probabilities IBD calculations converted combinations parents. genotype x marker combination probability comes particular parent high enough (higher \\(0.85 / number \\; \\; parents\\)), parent included output genotype x marker combination. opened Flapjack results look like :","code":"## Write results to Flapjack format. writeFlapjack(SxMIBD_Ext,               outFileMap = \"map.txt\",               outFileGeno = \"geno.txt\")"},{"path":"/articles/IBDCalculations.html","id":"simulated-data","dir":"Articles","previous_headings":"","what":"Simulated data","title":"IBD calculations using statgenIBD","text":"Simulated data several complex populations crosses included package. small just used purpose showing options output formats statgenIBD.","code":""},{"path":"/articles/IBDCalculations.html","id":"f4","dir":"Articles","previous_headings":"Simulated data","what":"F4","title":"IBD calculations using statgenIBD","text":"First look F4 two-way RIL population, .e. F1 followed 3 generations selfing. population constructed parents B. can see table populations section, computations F4 populations, can use popType = \"Fx\" x replaced 4. summary shows, output contains probabilities two parents, B. heterozygote, allele parents called AB. previous example can extract IBD probabilities analysis. However case might useful get probabilities , B AB, get probabilities two parents including AB. probability calculated \\(probability + 0.5 * probability AB\\). Summing probabilities like can done specifying sumProbs = TRUE getProbs.","code":"## Compute IBD probabilities for simulated F4 population. F4IBD <- calcIBD(popType = \"F4\",                  markerFile = system.file(\"extdata/popF4\", \"cross.txt\",                                           package = \"statgenIBD\"),                  mapFile = system.file(\"extdata/popF4\", \"mapfile.txt\",                                        package = \"statgenIBD\"))  ## Print summary. summary(F4IBD) #> population type:  F4  #> Number of evaluation points:  11  #> Number of individuals:  10  #> Parents:  A B ## Extract marker probabilities for markers M1_2 and M1_4. F4_probs <- getProbs(F4IBD, markers = c(\"M1_2\", \"M1_4\")) head(F4_probs) #>        geno     M1_2_A     M1_2_B   M1_2_AB     M1_4_A     M1_4_B    M1_4_AB #> 1 cross0001 0.48148327 0.45198692 0.0665298 0.48969130 0.44861702 0.06169168 #> 2 cross0002 0.00000000 0.00000000 1.0000000 0.05416181 0.05416181 0.89167637 #> 3 cross0003 1.00000000 0.00000000 0.0000000 0.95581746 0.01574904 0.02843350 #> 4 cross0004 0.00000000 1.00000000 0.0000000 0.01461051 0.97205517 0.01333432 #> 5 cross0005 0.00000000 1.00000000 0.0000000 0.01461051 0.97205517 0.01333432 #> 6 cross0006 0.05416181 0.05416181 0.8916764 0.05416181 0.05416181 0.89167637 ## Extract marker probabilities for markers M1_2 and M1_4. ## Sum the probabilities to probabilities per parent. F4_probs_sum <- getProbs(F4IBD, markers = c(\"M1_2\", \"M1_4\"), sumProbs = TRUE) head(F4_probs_sum) #>        geno    M1_2_A     M1_4_A    M1_2_B     M1_4_B #> 1 cross0001 0.5147482 0.52053714 0.4852518 0.47946286 #> 2 cross0002 0.5000000 0.50000000 0.5000000 0.50000000 #> 3 cross0003 1.0000000 0.97003421 0.0000000 0.02996579 #> 4 cross0004 0.0000000 0.02127767 1.0000000 0.97872233 #> 5 cross0005 0.0000000 0.02127767 1.0000000 0.97872233 #> 6 cross0006 0.5000000 0.50000000 0.5000000 0.50000000"},{"path":"/articles/IBDCalculations.html","id":"c4s3","dir":"Articles","previous_headings":"Simulated data","what":"C4S3","title":"IBD calculations using statgenIBD","text":"Also included C4S3 population, four-way cross followed 3 generations selfing. parents four-way cross , B, C D, first 4 rows genotypic file. crossing scheme (x B) x (C x D), followed 3 generations selfing. summary shows, output contains probabilities four parents, , B, C, D, plus four possible heterozygote genotypes: AC, AD, BC, BD.","code":"## Compute IBD probabilities for simulated C4S3 population. C4S3IBD <- calcIBD(popType = \"C4S3\",                    markerFile = system.file(\"extdata/popC4S3\", \"cross.txt\",                                             package = \"statgenIBD\"),                    mapFile = system.file(\"extdata/popC4S3\", \"mapfile.txt\",                                          package = \"statgenIBD\"))  ## Print summary. summary(C4S3IBD) #> population type:  C4S3  #> Number of evaluation points:  11  #> Number of individuals:  10  #> Parents:  A B C D"},{"path":"/articles/IBDCalculations.html","id":"multi-cross","dir":"Articles","previous_headings":"Simulated data","what":"Multi-cross","title":"IBD calculations using statgenIBD","text":"final example shows IBD computations multiple populations can combined. example use simulated data two F4DH populations, .e. F4 population described followed doubled haploid generation. first population parents B, second parents C. simple example NAM population, parent central parent. First compute IBD probabilities populations separately. Now want combine results computations analyses. combine IBDprob objects can use c function. possible objects contain type population. Also evaluation points objects identical. example two F4DH populations used map file computations combining fine. Looking summary, can see combined population now 180 individuals, 100 population AB 80 population AC. also three parents, , B C. individuals population AB probability parent C 0, probability parent B individuals population AC. Note output now contains extra column cross, indicating cross genotype came . value 0 either parent B parent C also shows clearly plots . left plot shows individual first cross, right one individual second cross.  Plotting genotypes together also shows clear separation crosses ABC.","code":"## Compute IBD probabilties for AxB. AB <- calcIBD(popType = \"F4DH\",               markerFile = system.file(\"extdata/multipop\", \"AxB.txt\",                                        package = \"statgenIBD\"),               mapFile = system.file(\"extdata/multipop\", \"mapfile.txt\",                                     package = \"statgenIBD\"),               evalDist = 1)  ## Print summary. summary(AB) #> population type:  F4DH  #> Number of evaluation points:  495  #> Number of individuals:  100  #> Parents:  A B  ## Compute IBD probabilties for AxC. AC <- calcIBD(popType = \"F4DH\",               markerFile = system.file(\"extdata/multipop\", \"AxC.txt\",                                        package = \"statgenIBD\"),               mapFile = system.file(\"extdata/multipop\", \"mapfile.txt\",                                     package = \"statgenIBD\"),               evalDist = 1)  ## Print summary. summary(AC) #> population type:  F4DH  #> Number of evaluation points:  495  #> Number of individuals:  80  #> Parents:  A C ABC <- c(AB, AC) summary(ABC) #> population type:  F4DH  #> Number of evaluation points:  495  #> Number of individuals:  180  #> Parents:  A B C ## Extract probabilities for markers EXT_1_1 and EXT_1_3. ABCProbs <- getProbs(ABC, markers = c(\"EXT_1_1\", \"EXT_1_3\"))  ## Print probabilities for genotypes AxB0001 and AxC0001. ABCProbs[ABCProbs$geno %in% c(\"AxB0001\", \"AxC0001\"), ] #>      cross    geno EXT_1_1_A  EXT_1_1_B EXT_1_1_C  EXT_1_3_A EXT_1_3_B EXT_1_3_C #> 1   cross1 AxB0001 0.9600100 0.03998997 0.0000000 0.88351079 0.1164892 0.0000000 #> 101 cross2 AxC0001 0.1208691 0.00000000 0.8791309 0.09765978 0.0000000 0.9023402 plot(ABC, genotype = \"AxB0001\") plot(ABC, genotype = \"AxC0001\") plot(ABC, plotType = \"allGeno\")"},{"path":"/articles/IBDCalculations.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"IBD calculations using statgenIBD","text":"Hayes, P. M., B. H. Liu, S. J. Knapp, F. Chen, B. Jones, T. Blake, J. Franckowiak, et al. 1993. “Quantitative Trait Locus Effects Environmental Interaction Sample North American Barley Germ Plasm.” Theoretical Applied Genetics 87 (3): 392–401. https://doi.org/10.1007/bf01184929. Huang, Xueqing, Maria-João Paulo, Martin Boer, Sigi Effgen, Paul Keizer, Maarten Koornneef, Fred Van Eeuwijk. 2011. “Analysis natural allelic variation Arabidopsis using multiparent recombinant inbred line population.” https://doi.org/10.1073/pnas.1100465108. Lander, Eric S., Philip Green. 1987. “Construction multilocus genetic linkage maps humans (restriction fragment length polymorphism/EM algorithm/genetic reconstruction algorithm/human genetics/plant genetics).” Proc. Nati. Acad. Sci. USA 84 (2): 2363–7. https://www.jstor.org/stable/29713. Milne, ., P. Shaw, G. Stephen, M. Bayer, L. Cardle, W. T. B. Thomas, . J. Flavell, D. Marshall. 2010. “Flapjack–Graphical Genotype Visualization.” Bioinformatics 26 (24): 3133–4. https://doi.org/10.1093/bioinformatics/btq580. Van Eeuwijk, Fred ., Martin Boer, L. Radu Totir, Marco Bink, Deanne Wright, Christopher R. Winkler, Dean Podlich, et al. 2009. “Mixed model approaches identification QTLs within maize hybrid breeding program.” Theor. Appl. Genet. 2009 1202 120 (2): 429–40. https://doi.org/10.1007/S00122-009-1205-0. Zheng, Chaozhi, Martin P Boer, Fred Van Eeuwijk. 2015. “Reconstruction Genome Ancestry Blocks Multiparental Populations.” Genetics 200 (4): 1073–87. https://doi.org/10.1534/GENETICS.115.177873. ———. 2018. “Recursive Algorithms Modeling Genomic Ancestral Origins Fixed Pedigree.” G3 Genes|Genomes|Genetics 8 (10): 3231–45. https://doi.org/10.1534/G3.118.200340. ———. 2014. “General Modeling Framework Genome Ancestral Origins Multiparental Populations.” Genetics 198 (1): 87–101. https://doi.org/10.1534/genetics.114.163006.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Martin Boer. Author. Bart-Jan van Rossum. Author, maintainer. Wenhao Li. Contributor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Boer M, van Rossum B (2022). statgenIBD: Calculation IBD Probabilities. https://biometris.github.io/statgenIBD/index.html, https://github.com/Biometris/statgenIBD/.","code":"@Manual{,   title = {statgenIBD: Calculation of IBD Probabilities},   author = {Martin Boer and Bart-Jan {van Rossum}},   year = {2022},   note = {https://biometris.github.io/statgenIBD/index.html, https://github.com/Biometris/statgenIBD/}, }"},{"path":"/index.html","id":"statgenibd","dir":"","previous_headings":"","what":"An R package for calculation of Identity by Descent probabilities","title":"An R package for calculation of Identity by Descent probabilities","text":"statgenIBD R package calculating IBD probabilities biparental, three four-way crosses. Calculations based Hidden Markov Models (HMM) inheritance vectors.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"An R package for calculation of Identity by Descent probabilities","text":"Install CRAN: Install latest development version GitHub (requires remotes package):","code":"install.packages(\"statgenIBD\") remotes::install_github(\"Biometris/statgenIBD\", ref = \"develop\", dependencies = TRUE)"},{"path":"/reference/allGenoPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function for plotting probabilities for all genotypes — allGenoPlot","title":"Helper function for plotting probabilities for all genotypes — allGenoPlot","text":"Helper function plotting probabilities genotypes","code":""},{"path":"/reference/allGenoPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function for plotting probabilities for all genotypes — allGenoPlot","text":"","code":"allGenoPlot(markers, map, parents, title)"},{"path":"/reference/c.IBDprob.html","id":null,"dir":"Reference","previous_headings":"","what":"Concatenate function for objects of class IBDprob — c.IBDprob","title":"Concatenate function for objects of class IBDprob — c.IBDprob","text":"Concatenates objects class IBDprob. objects concatenated  population type map. function mainly meant combining information multiple crosses overlapping parents.","code":""},{"path":"/reference/c.IBDprob.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Concatenate function for objects of class IBDprob — c.IBDprob","text":"","code":"# S3 method for IBDprob c(...)"},{"path":"/reference/c.IBDprob.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Concatenate function for objects of class IBDprob — c.IBDprob","text":"... Objects class IBDprob.","code":""},{"path":"/reference/c.IBDprob.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Concatenate function for objects of class IBDprob — c.IBDprob","text":"object class IBDprob containing data concatenated objects.","code":""},{"path":"/reference/c.IBDprob.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Concatenate function for objects of class IBDprob — c.IBDprob","text":"","code":"## Compute IBD probabilties for AxB. AB <- calcIBD(popType = \"F4DH\",              markerFile = system.file(\"extdata/multipop\", \"AxB.txt\",                                   package = \"statgenIBD\"),              mapFile = system.file(\"extdata/multipop\", \"mapfile.txt\",                                   package = \"statgenIBD\")) ## Compute IBD probabilties for Axc. AC <- calcIBD(popType = \"F4DH\",               markerFile = system.file(\"extdata/multipop\", \"AxC.txt\",                                       package = \"statgenIBD\"),               mapFile = system.file(\"extdata/multipop\", \"mapfile.txt\",                                    package = \"statgenIBD\"))  ## Combine results. ABC <- c(AB, AC)  ## Check summary. summary(ABC) #> population type:  F4DH  #> Number of evaluation points:  55  #> Number of individuals:  180  #> Parents:  A B C"},{"path":"/reference/calcIBD.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate IBD probabilities — calcIBD","title":"Calculate IBD probabilities — calcIBD","text":"Calculate IBD probabilities different types populations.","code":""},{"path":"/reference/calcIBD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate IBD probabilities — calcIBD","text":"","code":"calcIBD(   popType,   markerFile,   mapFile,   evalPos = NULL,   evalDist = NULL,   grid = TRUE,   verbose = FALSE )"},{"path":"/reference/calcIBD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate IBD probabilities — calcIBD","text":"popType character string indicating type population. One DH, Fx, FxDH, BCx, BCxDH, BC1Sx, BC1SxDH, C3, C3DH, C3Sx, C3SxDH, C4, C4DH, C4Sx, C4SxDH (see Details). markerFile character string indicating location file genotypic information population. file tab-delimited format header containing marker names. mapFile character string indicating location map file population. file tab-delimited format. consist exactly three columns, marker, chromosome position. header. positions file centimorgan. evalPos data.frame evaluation positions calculations limited. evalDist optional numerical value indicating maximum distance marker positions. Extra markers added based value grid. grid extra markers added assure maximum distince evalDist grid (TRUE) marker existing marker positions (FALSE). verbose messages indicating progress process printed?","code":""},{"path":"/reference/calcIBD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate IBD probabilities — calcIBD","text":"object class IBDprob, list five elements, map data.frame chromosome position markers. markers 3-dimensional array IBD probabilities markers, genotypes  parents array dimensions. parents parents. popType population type. multiCross logical value indicating multiple crosses combined IBDprob object.","code":""},{"path":"/reference/calcIBD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate IBD probabilities — calcIBD","text":"IBD probabilities can calculated many different types populations. following table supported populations listed. Note value x population types variable, maximum value depicted last column.","code":""},{"path":"/reference/calcIBD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate IBD probabilities — calcIBD","text":"","code":"## Compute IBD probabilities for Steptoe Morex. SxMIBD <- calcIBD(popType = \"DH\",                   markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                         package = \"statgenIBD\"),                   mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                         package = \"statgenIBD\"))  ## Check summary. summary(SxMIBD) #> population type:  DH  #> Number of evaluation points:  116  #> Number of individuals:  150  #> Parents:  Morex Steptoe   ## Compute IBD probabilities for Steptoe Morex. ## Add extra evaluation positions in between exiting marker positions ## to assure evaluation positions are at most 5 cM apart. SxMIBD_Ext <- calcIBD(popType = \"DH\",                       markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                               package = \"statgenIBD\"),                       mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                             package = \"statgenIBD\"),                       evalDist = 5)  ## Check summary. summary(SxMIBD_Ext) #> population type:  DH  #> Number of evaluation points:  226  #> Number of individuals:  150  #> Parents:  Morex Steptoe"},{"path":"/reference/getProbs.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Probabilities for markers — getProbs","title":"Extract Probabilities for markers — getProbs","text":"Extract IBD probabilities one markers object class IBDprob.","code":""},{"path":"/reference/getProbs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Probabilities for markers — getProbs","text":"","code":"getProbs(IBDprob, markers, sumProbs = FALSE)"},{"path":"/reference/getProbs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Probabilities for markers — getProbs","text":"IBDprob object class IBDprob. markers character vector markers extracted. sumProbs probabilities summed per parent. TRUE probability e.g. parent cross parent B calculated pA + 0.5 * pAB. FALSE pA pAB output without calculations.","code":""},{"path":"/reference/getProbs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Probabilities for markers — getProbs","text":"data.frame IBD probabilities extracted markers column genotypes rows.","code":""},{"path":"/reference/getProbs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Probabilities for markers — getProbs","text":"","code":"## Compute IBD probabilities for Steptoe Morex. SxMIBD <- calcIBD(popType = \"DH\",                   markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                         package = \"statgenIBD\"),                   mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                         package = \"statgenIBD\"))  ## Get probabilities for a single marker. probOne <- getProbs(IBDprob = SxMIBD,                     markers = \"plc\") head(probOne) #>    geno plc_Morex plc_Steptoe #> 1 dh001         0           1 #> 2 dh002         0           1 #> 3 dh003         0           1 #> 4 dh004         0           1 #> 5 dh005         0           1 #> 6 dh006         0           1  ## Get probabilities for a multiple markers. probMult <- getProbs(IBDprob = SxMIBD,                      markers = c(\"plc\", \"tuba1\")) head(probMult) #>    geno plc_Morex plc_Steptoe tuba1_Morex tuba1_Steptoe #> 1 dh001         0           1   0.9790059    0.02099409 #> 2 dh002         0           1   0.9576280    0.04237201 #> 3 dh003         0           1   0.9790059    0.02099409 #> 4 dh004         0           1   0.0000000    1.00000000 #> 5 dh005         0           1   1.0000000    0.00000000 #> 6 dh006         0           1   1.0000000    0.00000000"},{"path":"/reference/pedPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function for plotting the pedigree — pedPlot","title":"Helper function for plotting the pedigree — pedPlot","text":"Helper function plotting pedigree","code":""},{"path":"/reference/pedPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function for plotting the pedigree — pedPlot","text":"","code":"pedPlot(pedigree, offSpring, popType, multiCross, genoCross, title)"},{"path":"/reference/plot.IBDprob.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot function for objects of class IBDprob — plot.IBDprob","title":"Plot function for objects of class IBDprob — plot.IBDprob","text":"Creates plot object class IBDprob. Three types plot can made: singleGeno plot single genotype showing IBD probabilities parents across genome. allGeno plot showing genotypes IBD probabilities parent highest probability per marker. pedigree plot showing structure pedigree population.","code":""},{"path":"/reference/plot.IBDprob.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot function for objects of class IBDprob — plot.IBDprob","text":"","code":"# S3 method for IBDprob plot(   x,   ...,   plotType = c(\"singleGeno\", \"allGeno\", \"pedigree\"),   genotype,   title = NULL,   output = TRUE )"},{"path":"/reference/plot.IBDprob.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot function for objects of class IBDprob — plot.IBDprob","text":"x object class IBDprob. ... arguments. Unused. plotType character string indicating type plot made. genotype character string indicating genotype plot made. plotType = \"singleGeno\". title character string, title plot. output plot output current device? FALSE, ggplot object invisibly returned.","code":""},{"path":"/reference/plot.IBDprob.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot function for objects of class IBDprob — plot.IBDprob","text":"ggplot object invisibly returned.","code":""},{"path":"/reference/plot.IBDprob.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot function for objects of class IBDprob — plot.IBDprob","text":"","code":"## Compute IBD probabilities for Steptoe Morex. ## Add extra evaluation positions in between exiting marker positions ## to assure evaluation positions are at most 2 cM apart. SxMIBD_Ext <- calcIBD(popType = \"DH\",                       markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                               package = \"statgenIBD\"),                       mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                            package = \"statgenIBD\"),                       evalDist = 2)  ## Plot results for genotype dh005. plot(SxMIBD_Ext,      plotType = \"singleGeno\",      genotype = \"dh005\")   ## Plot results for all genotypes. plot(SxMIBD_Ext,      plotType = \"allGeno\")   ## Plot sturcture of the pedigree. plot(SxMIBD_Ext,      plotType = \"pedigree\")"},{"path":"/reference/singleGenoPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function for plotting probabilities for a single genotype — singleGenoPlot","title":"Helper function for plotting probabilities for a single genotype — singleGenoPlot","text":"Helper function plotting probabilities single genotype","code":""},{"path":"/reference/singleGenoPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function for plotting probabilities for a single genotype — singleGenoPlot","text":"","code":"singleGenoPlot(markers, map, parents, genotype, title)"},{"path":"/reference/statgenIBD-package.html","id":null,"dir":"Reference","previous_headings":"","what":"statgenIBD: Calculation of IBD Probabilities — statgenIBD-package","title":"statgenIBD: Calculation of IBD Probabilities — statgenIBD-package","text":"biparental, three four-way crosses Identity Descent (IBD) probabilities can calculated using Hidden Markov Models inheritance vectors following Lander Green (<https://www.jstor.org/stable/29713>) Huang (<doi:10.1073/pnas.1100465108>). One series statistical genetic packages streamlining analysis typical plant breeding experiments developed Biometris.","code":""},{"path":[]},{"path":"/reference/statgenIBD-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"statgenIBD: Calculation of IBD Probabilities — statgenIBD-package","text":"Maintainer: Bart-Jan van Rossum bart-jan.vanrossum@wur.nl (ORCID) Authors: Martin Boer martin.boer@wur.nl (ORCID) contributors: Wenhao Li [contributor]","code":""},{"path":"/reference/summary.IBDprob.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary function for objects of class IBDprob — summary.IBDprob","title":"Summary function for objects of class IBDprob — summary.IBDprob","text":"Prints short summary objects class IBDprob. summary consists population type, number evaluation points, number individuals names parents object.","code":""},{"path":"/reference/summary.IBDprob.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary function for objects of class IBDprob — summary.IBDprob","text":"","code":"# S3 method for IBDprob summary(object, ...)"},{"path":"/reference/summary.IBDprob.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary function for objects of class IBDprob — summary.IBDprob","text":"object object class IBDprob. ... used.","code":""},{"path":"/reference/summary.IBDprob.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary function for objects of class IBDprob — summary.IBDprob","text":"return value, summary printed.","code":""},{"path":"/reference/summary.IBDprob.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary function for objects of class IBDprob — summary.IBDprob","text":"","code":"## Compute IBD probabilities for Steptoe Morex. SxMIBD <- calcIBD(popType = \"DH\",                   markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                           package = \"statgenIBD\"),                   mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                         package = \"statgenIBD\"))  ## Print summary summary(SxMIBD) #> population type:  DH  #> Number of evaluation points:  116  #> Number of individuals:  150  #> Parents:  Morex Steptoe"},{"path":"/reference/writeFlapjack.html","id":null,"dir":"Reference","previous_headings":"","what":"Write to Flapjack format — writeFlapjack","title":"Write to Flapjack format — writeFlapjack","text":"Export results IBD calculation Flapjack format can visualized .","code":""},{"path":"/reference/writeFlapjack.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write to Flapjack format — writeFlapjack","text":"","code":"writeFlapjack(   IBDprob,   outFileMap = \"ibd_map.txt\",   outFileGeno = \"ibd_geno.txt\" )"},{"path":"/reference/writeFlapjack.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write to Flapjack format — writeFlapjack","text":"IBDprob object class IBDprob. outFileMap character string, full path output map file. outFileGeno character string, full path output genotype file.","code":""},{"path":"/reference/writeFlapjack.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write to Flapjack format — writeFlapjack","text":"output. Output files written folder.","code":""},{"path":"/reference/writeFlapjack.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write to Flapjack format — writeFlapjack","text":"","code":"## Compute IBD probabilities for Steptoe Morex. SxMIBD <- calcIBD(popType = \"DH\",                   markerFile = system.file(\"extdata/SxM\", \"SxM_geno.txt\",                                           package = \"statgenIBD\"),                   mapFile = system.file(\"extdata/SxM\", \"SxM_map.txt\",                                        package = \"statgenIBD\"))  ## Write output in Flapjack format to temporary files. writeFlapjack(SxMIBD,               outFileMap = tempfile(fileext = \".txt\"),               outFileGeno = tempfile(fileext = \".txt\"))"},{"path":"/news/index.html","id":"statgenibd-103","dir":"Changelog","previous_headings":"","what":"statgenIBD 1.0.3","title":"statgenIBD 1.0.3","text":"now possible plot pedigree object class IBDprob specifying plotType = \"pedigree\". small bug calculation probabilities populations C3 C4 fixed.","code":""},{"path":"/news/index.html","id":"statgenibd-102","dir":"Changelog","previous_headings":"","what":"statgenIBD 1.0.2","title":"statgenIBD 1.0.2","text":"CRAN release: 2021-12-10 now possible specify chromosomes character format, .e. 1a, 1b, 1c common certain crops. plot function calculated IBD probabilities now extra option plotType can values “singleGeno”, original plot, “allGeno” new plot showing probabilities genotypes single plot. bug cases lead misnaming markers combining multiple imputed populations fixed.","code":""},{"path":"/news/index.html","id":"statgenibd-101","dir":"Changelog","previous_headings":"","what":"statgenIBD 1.0.1","title":"statgenIBD 1.0.1","text":"CRAN release: 2021-09-14 bug written Flapjack files read fixed.","code":""},{"path":"/news/index.html","id":"statgenibd-100","dir":"Changelog","previous_headings":"","what":"statgenIBD 1.0.0","title":"statgenIBD 1.0.0","text":"CRAN release: 2021-08-16 Initial CRAN version","code":""}]
